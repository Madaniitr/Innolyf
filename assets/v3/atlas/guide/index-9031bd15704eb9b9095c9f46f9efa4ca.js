function getFormData(e){var t=[].slice.call(e.querySelectorAll("[name]")),n={};return t.forEach(function(e){n[e.getAttribute("name")]=e.value}),n}function submitForm(e){var t=document.querySelector("meta[name=csrf-token]").getAttribute("content"),n=getFormData(e),r=new XMLHttpRequest;r.addEventListener("load",submitDone),r.open("POST.html","/atlas"),r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r.setRequestHeader("x-stripe-csrf-token",t),r.send(JSON.stringify(n))}function submitDone(){modal.classList.add("success")}var modalOverlay=document.querySelector(".modal-overlay"),modal=modalOverlay.querySelector(".join-modal"),form=modal.querySelector("form"),submitButton=form.querySelector("input[type='submit']"),closeButton=modal.querySelector("a.close"),HASHES=["#join","#apply","#request-access"],showJoinModal=function(){modalOverlay.classList.add("visible"),modal.querySelectorAll("input[type='text']")[0].focus()},hideJoinModal=function(){modalOverlay.classList.remove("visible"),history.replaceState(undefined,undefined,"#"),setTimeout(function(){submitButton.classList.remove("common-Button--disabled"),modal.classList.remove("success")},350)};modalOverlay.addEventListener("click",hideJoinModal),closeButton.addEventListener("click",hideJoinModal),modal.addEventListener("click",function(e){e.stopPropagation()}),document.addEventListener("keyup",function(e){e.keyCode==27&&hideJoinModal()}),window.addEventListener("hashchange",function(){HASHES.indexOf(location.hash)>-1&&showJoinModal()}),document.addEventListener("DOMContentLoaded",function(){HASHES.indexOf(location.hash)>-1&&showJoinModal()}),form.addEventListener("submit",function(e){e.preventDefault();var t=[].slice.call(form.querySelectorAll("*[required]")),n=!0;t.forEach(function(e){e.validity.valid?e.parentNode.classList.remove("invalid"):(n=!1,e.parentNode.classList.add("invalid"))}),n&&(submitButton.classList.add("common-Button--disabled"),submitForm(form))}),function(){"use strict";var e=document.querySelector(".toc ul"),t=[].slice.call(document.querySelectorAll(".guide-content h1")),n=null,r=.5;t.forEach(function(t){var n=document.createElement("li");e.appendChild(n),n.innerHTML='<a class="common-Link scroll" href="#'+t.getAttribute("id")+'">'+t.innerText+"</a>"}),window.addEventListener("scroll",function(){var e=t.filter(function(e){return 1-e.getBoundingClientRect().top/window.innerHeight>r});n!=e[e.length-1]&&(n=e[e.length-1],t.forEach(function(e){e==n?document.querySelector('.toc a[href="#'+e.getAttribute("id")+'"]').classList.add("current"):document.querySelector('.toc a[href="#'+e.getAttribute("id")+'"]').classList.remove("current")}))}),Stickyfill.add(document.querySelector(".toc"));var i=document.querySelector(".image-container"),s=i.querySelector(".overlay"),o=i.querySelector(".image"),u,a=function(e,t){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),i={x:n.left-r.left,y:n.top-r.top},s=n.width/r.width;return{translation:i,scale:s}},f=function(e,t){i.style.pointerEvents="all",u=e,o.querySelector("img").setAttribute("src",u.getAttribute("src")),o.querySelector("img").style.willChange="transform",setTimeout(function(){o.style.transform="none";var e=a(u,o);o.style.transform="translate("+e.translation.x+"px,"+e.translation.y+"px) scale("+e.scale+")",u.style.opacity="0",o.style.opacity="1",animate({el:o,translateX:[e.translation.x,0],translateY:[e.translation.y,0],scale:[e.scale,1],duration:t,easing:"easeOutElastic 100"}),animate({el:o.querySelector(".shadow"),opacity:[0,1],duration:t,easing:"easeOutElastic 100"}),animate({el:s,opacity:[0,1],duration:t,easing:"easeOutElastic 100",complete:function(){o.querySelector("img").style.willChange="auto"}})},10)},l=function(e){if(u){i.style.pointerEvents="none";var t=a(u,o);animate({el:o,translateX:[0,t.translation.x],translateY:[0,t.translation.y],scale:[1,t.scale],duration:e,easing:"easeOutElastic 100"}),animate({el:o.querySelector(".shadow"),opacity:[1,0],duration:e,easing:"easeOutElastic 100"}),animate({el:s,opacity:[1,0],duration:e,easing:"easeOutElastic 100",complete:function(){u.style.opacity="1",o.style.opacity="0",u=null,o.querySelector("img").style.willChange="auto"}})}};document.addEventListener("click",function(e){e.target.classList.contains("expandable")?f(e.target,500):e.target==i&&l(500)}),document.addEventListener("keyup",function(e){e.keyCode==27&&l(500)})}();